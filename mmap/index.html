<!DOCTYPE html>
<html>
<head>
  <title>The Real Marauder's Map</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script type="text/javascript">
    // username: JoshRamsey
    function make_map(lat, lng){
      var mapOptions = {
        center: { lat: lat, lng: lng},
        zoom: 11
      };
      var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
    }

    function sendLocationData(pos){
      lat = pos.coords.latitude;
      lng = pos.coords.longitude;
      alert("lat: " + lat + " lng: " + lng);
      request = new XMLHttpRequest();
      request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      requestURL = "https://secret-about-box.herokuapp.com/sendLocation"
      requestWithParams = requestURL + "?login=JoshRamsey&lat=" + lat +"&lng=" + lng;
      alert(requestWithParams);
      request.open("POST", requestWithParams, true);
      request.onreadystatechange = parseMapData;
      request.send();
      make_map(lat, lng);
    }

    function parseMapData(){
      alert("parsing map data")
      if(request.readyState == 4 && request.status == 200){
        responseObject = JSON.parse(request.responseText);
        console.log(responseObject);
      }
    }

    navigator.geolocation.getCurrentPosition(sendLocationData, alert("GeoLocation failed", {}));
  </script>
</head>
<body>
  <div id="map-canvas" style="width:100%; height:100%"></div>
</body>
</html>